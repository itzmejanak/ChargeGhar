â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“¦ APP: payments
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“„ VIEWS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
api/payments/views/
â”œâ”€â”€ __init__.py                # Router merge
â”œâ”€â”€ admin_views.py             # Admin refund management - approve and reject refunds (3 classes)
â”‚   â”œâ”€â”€ AdminRefundRequestsView
â”‚   â”œâ”€â”€ AdminApproveRefundView
â”‚   â””â”€â”€ AdminRejectRefundView
â”œâ”€â”€ core_views.py              # Core payment functionality - transactions, packages, and methods (4 classes)
â”‚   â”œâ”€â”€ TransactionListView
â”‚   â”œâ”€â”€ RentalPackageListView
â”‚   â”œâ”€â”€ PaymentMethodListView
â”‚   â””â”€â”€ CalculatePaymentOptionsView
â”œâ”€â”€ refund_views.py            # User refund operations - list and request refunds (1 classes)
â”‚   â””â”€â”€ RefundListView
â””â”€â”€ wallet_views.py            # Wallet operations - topup, balance, verify, and cancel (4 classes)
    â”œâ”€â”€ TopupIntentCreateView
    â”œâ”€â”€ PaymentVerifyView
    â”œâ”€â”€ WalletBalanceView
    â””â”€â”€ PaymentCancelView

Total: 4 files, 12 view classes

âš™ï¸  SERVICES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
api/payments/services/
â”œâ”€â”€ __init__.py                    # Exports
â”œâ”€â”€ nepal_gateway.py               # Service operations
â”‚   â””â”€â”€ NepalGatewayService
â”‚       â”œâ”€â”€ __init__()
â”‚       â”œâ”€â”€ esewa_client()
â”‚       â”œâ”€â”€ khalti_client()
â”‚       â”œâ”€â”€ convert_amount_for_gateway()
â”‚       â”œâ”€â”€ convert_amount_from_gateway()
â”‚       â”œâ”€â”€ initiate_esewa_payment()
â”‚       â”œâ”€â”€ verify_esewa_payment()
â”‚       â”œâ”€â”€ initiate_khalti_payment()
â”‚       â””â”€â”€ verify_khalti_payment()
â”œâ”€â”€ payment_calculation.py         # Service operations
â”‚   â””â”€â”€ PaymentCalculationService
â”‚       â”œâ”€â”€ calculate_payment_options()
â”‚       â”œâ”€â”€ calculate_package_payment_options()
â”‚       â”œâ”€â”€ _get_user_points()
â”‚       â”œâ”€â”€ _get_wallet_balance()
â”‚       â””â”€â”€ _calculate_payment_breakdown()
â”œâ”€â”€ payment_intent.py              # Service operations
â”‚   â””â”€â”€ PaymentIntentService
â”‚       â”œâ”€â”€ create_topup_intent()
â”‚       â”œâ”€â”€ _initiate_gateway_payment()
â”‚       â”œâ”€â”€ verify_topup_payment()
â”‚       â”œâ”€â”€ _verify_with_gateway()
â”‚       â”œâ”€â”€ get_payment_status()
â”‚       â””â”€â”€ cancel_payment_intent()
â”œâ”€â”€ refund.py                      # Service operations
â”‚   â””â”€â”€ RefundService
â”‚       â”œâ”€â”€ request_refund()
â”‚       â”œâ”€â”€ get_user_refunds()
â”‚       â”œâ”€â”€ approve_refund()
â”‚       â”œâ”€â”€ get_pending_refunds()
â”‚       â””â”€â”€ reject_refund()
â”œâ”€â”€ rental_payment.py              # Service operations
â”‚   â””â”€â”€ RentalPaymentService
â”‚       â”œâ”€â”€ process_rental_payment()
â”‚       â””â”€â”€ pay_rental_due()
â”œâ”€â”€ transaction.py                 # Service operations
â”‚   â””â”€â”€ TransactionService
â”‚       â”œâ”€â”€ get_user_transactions()
â”‚       â””â”€â”€ get_user_transactions_queryset()
â””â”€â”€ wallet.py                      # Service operations
    â””â”€â”€ WalletService
        â”œâ”€â”€ get_or_create_wallet()
        â”œâ”€â”€ add_balance()
        â”œâ”€â”€ deduct_balance()
        â”œâ”€â”€ get_wallet_balance()
        â””â”€â”€ get_wallet_balance()

Total: 7 files, 7 service classes, 34 methods

ğŸ“‹ SERIALIZERS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
api/payments/serializers.py          # Single file (408 lines)
â”œâ”€â”€ User Serializers
â”‚   â””â”€â”€ UserTransactionHistorySerializer
â”œâ”€â”€ Payment Serializers
â”‚   â”œâ”€â”€ PaymentMethodListSerializer
â”‚   â”œâ”€â”€ PaymentMethodSerializer
â”‚   â”œâ”€â”€ WalletSerializer
â”‚   â”œâ”€â”€ TransactionListSerializer
â”‚   â”œâ”€â”€ TransactionSerializer
â”‚   â”œâ”€â”€ TransactionDetailSerializer
â”‚   â”œâ”€â”€ WalletTransactionSerializer
â”‚   â”œâ”€â”€ PaymentIntentListSerializer
â”‚   â”œâ”€â”€ PaymentIntentSerializer
â”‚   â”œâ”€â”€ CalculatePaymentOptionsSerializer
â”‚   â”œâ”€â”€ PaymentOptionsResponseSerializer
â”‚   â”œâ”€â”€ RefundSerializer
â”‚   â”œâ”€â”€ RefundRequestSerializer
â”‚   â”œâ”€â”€ PaymentStatusSerializer
â”‚   â”œâ”€â”€ RefundActionSerializer
â”‚   â””â”€â”€ RefundRejectSerializer
â”œâ”€â”€ Rental Serializers
â”‚   â””â”€â”€ RentalPackageSerializer
â””â”€â”€ Other Serializers
    â”œâ”€â”€ TopupIntentCreateSerializer
    â”œâ”€â”€ PayDueSerializer
    â””â”€â”€ VerifyTopupSerializer

Total: 1 file, 21 serializers (4 categories)
